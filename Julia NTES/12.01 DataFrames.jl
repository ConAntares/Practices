# Scientific Computation: DataFrames

using DataFrames
using DataFramesMeta
using CSV

df1 = DataFrame()
df1[:clo11] = Array([1.0,2.0,3.0,4.0])
df1[:clo12] = Array([2.0,3.0,4.0,5.0])
df1[:clo13] = Array([3.0,4.0,5.0,6.0])
df1[:ID]   = Array(['A','B','C','D'])
show(df1)
    #   4×4 DataFrame
    # │ Row │ clo1    │ clo2    │ clo3    │ clo4    │
    # │     │ Float64 │ Float64 │ Float64 │ Float64 │
    # ├─────┼─────────┼─────────┼─────────┼─────────┤
    # │ 1   │ 1.0     │ 2.0     │ 3.0     │ 4.0     │
    # │ 2   │ 2.0     │ 3.0     │ 4.0     │ 5.0     │
    # │ 3   │ 3.0     │ 4.0     │ 5.0     │ 6.0     │
    # │ 4   │ 4.0     │ 5.0     │ 6.0     │ 7.0     │

df2 = DataFrame(rand(2,2))
show(df2)
    # 2×2 DataFrame
    # │ Row │ x1       │ x2       │
    # │     │ Float64  │ Float64  │
    # ├─────┼──────────┼──────────┤
    # │ 1   │ 0.292857 │ 0.52657  │
    # │ 2   │ 0.930055 │ 0.724489 │

df4 = DataFrame()
df4[:clo41] = Array([11.0,12.0,13.0,14.0])
df4[:clo42] = Array([12.0,13.0,14.0,15.0])
df4[:clo43] = Array([13.0,14.0,15.0,16.0])
df4[:ID]   = Array([ 'A', 'B', 'C','D' ])

df5 = join(df1,df4,on=:ID)
    # │ Row │ clo11   │ clo12   │ clo13   │ ID   │ clo41   │ clo42   │ clo43   │
    # │     │ Float64 │ Float64 │ Float64 │ Char │ Float64 │ Float64 │ Float64 │
    # ├─────┼─────────┼─────────┼─────────┼──────┼─────────┼─────────┼─────────┤
    # │ 1   │ 1.0     │ 2.0     │ 3.0     │ 'A'  │ 11.0    │ 12.0    │ 13.0    │
    # │ 2   │ 2.0     │ 3.0     │ 4.0     │ 'B'  │ 12.0    │ 13.0    │ 14.0    │
    # │ 3   │ 3.0     │ 4.0     │ 5.0     │ 'C'  │ 13.0    │ 14.0    │ 15.0    │
    # │ 4   │ 4.0     │ 5.0     │ 6.0     │ 'D'  │ 14.0    │ 15.0    │ 16.0    │

df5[2:5]
    # │ Row │ clo12   │ clo13   │ ID   │ clo41   │
    # │     │ Float64 │ Float64 │ Char │ Float64 │
    # ├─────┼─────────┼─────────┼──────┼─────────┤
    # │ 1   │ 2.0     │ 3.0     │ 'A'  │ 11.0    │
    # │ 2   │ 3.0     │ 4.0     │ 'B'  │ 12.0    │
    # │ 3   │ 4.0     │ 5.0     │ 'C'  │ 13.0    │
    # │ 4   │ 5.0     │ 6.0     │ 'D'  │ 14.0    │

#df5[2:4,[:2,:3,:4,:5]]
    # │ Row │ clo12   │ clo13   │ ID   │ clo41   │
    # │     │ Float64 │ Float64 │ Char │ Float64 │
    # ├─────┼─────────┼─────────┼──────┼─────────┤
    # │ 1   │ 3.0     │ 4.0     │ 'B'  │ 12.0    │
    # │ 2   │ 4.0     │ 5.0     │ 'C'  │ 13.0    │
    # │ 3   │ 5.0     │ 6.0     │ 'D'  │ 14.0    │

df5.clo11

for row in eachrow(df5)
    println(row)
end
    # DataFrameRow
    # │ Row │ clo11   │ clo12   │ clo13   │ ID   │ clo41   │ clo42   │ clo43   │
    # │     │ Float64 │ Float64 │ Float64 │ Char │ Float64 │ Float64 │ Float64 │
    # ├─────┼─────────┼─────────┼─────────┼──────┼─────────┼─────────┼─────────┤
    # │ 1   │ 1.0     │ 2.0     │ 3.0     │ 'A'  │ 11.0    │ 12.0    │ 13.0    │
    # DataFrameRow
    # │ Row │ clo11   │ clo12   │ clo13   │ ID   │ clo41   │ clo42   │ clo43   │
    # │     │ Float64 │ Float64 │ Float64 │ Char │ Float64 │ Float64 │ Float64 │
    # ├─────┼─────────┼─────────┼─────────┼──────┼─────────┼─────────┼─────────┤
    # │ 2   │ 2.0     │ 3.0     │ 4.0     │ 'B'  │ 12.0    │ 13.0    │ 14.0    │
    # DataFrameRow
    # │ Row │ clo11   │ clo12   │ clo13   │ ID   │ clo41   │ clo42   │ clo43   │
    # │     │ Float64 │ Float64 │ Float64 │ Char │ Float64 │ Float64 │ Float64 │
    # ├─────┼─────────┼─────────┼─────────┼──────┼─────────┼─────────┼─────────┤
    # │ 3   │ 3.0     │ 4.0     │ 5.0     │ 'C'  │ 13.0    │ 14.0    │ 15.0    │
    # DataFrameRow
    # │ Row │ clo11   │ clo12   │ clo13   │ ID   │ clo41   │ clo42   │ clo43   │
    # │     │ Float64 │ Float64 │ Float64 │ Char │ Float64 │ Float64 │ Float64 │
    # ├─────┼─────────┼─────────┼─────────┼──────┼─────────┼─────────┼─────────┤
    # │ 4   │ 4.0     │ 5.0     │ 6.0     │ 'D'  │ 14.0    │ 15.0    │ 16.0    │

#describe(df5)
df4
    # │ Row │ clo41   │ clo42   │ clo43   │ ID   │
    # │     │ Float64 │ Float64 │ Float64 │ Char │
    # ├─────┼─────────┼─────────┼─────────┼──────┤
    # │ 1   │ 11.0    │ 12.0    │ 13.0    │ 'A'  │
    # │ 2   │ 12.0    │ 13.0    │ 14.0    │ 'B'  │
    # │ 3   │ 13.0    │ 14.0    │ 15.0    │ 'C'  │
    # │ 4   │ 14.0    │ 15.0    │ 16.0    │ 'D'  │
sort!(df4,cols=[:3])
    # │ Row │ clo41   │ clo42   │ clo43   │ ID   │
    # │     │ Float64 │ Float64 │ Float64 │ Char │
    # ├─────┼─────────┼─────────┼─────────┼──────┤
    # │ 1   │ 11.0    │ 12.0    │ 13.0    │ 'A'  │
    # │ 2   │ 12.0    │ 13.0    │ 14.0    │ 'B'  │
    # │ 3   │ 13.0    │ 14.0    │ 15.0    │ 'C'  │
    # │ 4   │ 14.0    │ 15.0    │ 16.0    │ 'D'  │

CSV.write("df.csv",df4)
CSV.read("df.csv")
